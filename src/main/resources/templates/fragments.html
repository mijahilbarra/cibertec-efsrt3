<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:fragment="head(title)">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title} + ' - Sistema de Gestión Académica'">Sistema de Gestión Académica</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Sidebar Fragment -->
    <nav th:fragment="sidebar(activeSection)" class="col-md-3 col-lg-2 d-md-block bg-dark min-vh-100">
        <div class="position-sticky pt-3">
            <div class="text-center mb-4">
                <h4 class="text-white">
                    <i class="fas fa-graduation-cap"></i> Gestión Académica
                </h4>
                <!-- Show user name if logged in -->
                <small class="text-light" th:if="${session.usuarioNombre}">
                    <i class="fas fa-user"></i> <span th:text="${session.usuarioNombre}">Usuario</span>
                </small>
            </div>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link text-light" 
                       th:classappend="${activeSection == 'dashboard'} ? 'bg-secondary rounded active' : ''" 
                       href="/dashboard">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-light" 
                       th:classappend="${activeSection == 'usuarios'} ? 'bg-secondary rounded active' : ''" 
                       href="/usuarios">
                        <i class="fas fa-users"></i> Usuarios
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-light" 
                       th:classappend="${activeSection == 'proyectos'} ? 'bg-secondary rounded active' : ''" 
                       href="/proyectos">
                        <i class="fas fa-project-diagram"></i> Proyectos
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-light" 
                       th:classappend="${activeSection == 'proyectos-gestion'} ? 'bg-secondary rounded active' : ''" 
                       href="/proyectos/gestion">
                        <i class="fas fa-cogs"></i> Gestión de Proyectos
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-light" 
                       th:classappend="${activeSection == 'tutorias'} ? 'bg-secondary rounded active' : ''" 
                       href="/tutorias">
                        <i class="fas fa-chalkboard-teacher"></i> Tutorías
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-light" 
                       th:classappend="${activeSection == 'tutorias-gestion'} ? 'bg-secondary rounded active' : ''" 
                       href="/tutorias/gestion">
                        <i class="fas fa-cogs"></i> Gestión de Tutorías
                    </a>
                </li>
                <li class="nav-item mt-3">
                    <a class="nav-link text-danger" href="/logout">
                        <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Common Scripts Fragment -->
    <th:block th:fragment="scripts">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    </th:block>

    <!-- Firebase Scripts Fragment -->
    <th:block th:fragment="firebase-scripts">
        <!-- Firebase SDK -->
        <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
        <script>
            // Firebase Configuration
            const firebaseConfig = {
                apiKey: "AIzaSyCfAdBkYa8o1hgw1xLABRoutfPRe8DAk0Y",
                authDomain: "efsrt3-9df50.firebaseapp.com",
                projectId: "efsrt3-9df50",
                storageBucket: "efsrt3-9df50.firebasestorage.app",
                messagingSenderId: "964474154323",
                appId: "1:964474154323:web:410203973e7490004bc5a6",
                measurementId: "G-WYV0C8500N"
            };

            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            const storage = firebase.storage();
        </script>
    </th:block>

    <!-- Alert Messages Fragment -->
    <th:block th:fragment="alerts">
        <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="fas fa-check-circle"></i> <span th:text="${success}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="fas fa-exclamation-circle"></i> <span th:text="${error}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    </th:block>

    <!-- Pinterest-style Cards CSS Fragment -->
    <th:block th:fragment="cards-css">
        <style>
            .card-columns {
                column-count: 1;
                column-gap: 1.25rem;
                orphans: 1;
                widows: 1;
            }
            @media (min-width: 576px) {
                .card-columns { column-count: 2; }
            }
            @media (min-width: 768px) {
                .card-columns { column-count: 3; }
            }
            @media (min-width: 992px) {
                .card-columns { column-count: 4; }
            }
            .card {
                display: inline-block;
                width: 100%;
                margin-bottom: 1.25rem;
                break-inside: avoid;
            }
            .card-img-top {
                height: 200px;
                object-fit: cover;
            }
        </style>
    </th:block>
</body>
</html> 